<!-- This is the proper way if you have submit button outside your ion-content form (typically in the ion-header or ion-footer) -->
<!-- (ref: https://github.com/ionic-team/ionic/issues/16661) -->
<form class="ion-page" [formGroup]="reviewItemForm" (ngSubmit)="reviewItem()">
  <ion-header>
    <ion-toolbar color="primary">
      <ion-buttons slot="end">
        <ion-button (click)="dismissModal()">
          <ion-icon slot="icon-only" name="close"></ion-icon>
        </ion-button>
      </ion-buttons>
      <ion-title>{{ 'ReviewExperianceWith' | translate }} - {{ otherUserName }} - as {{ subject }}</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <section *ngIf="canRate">
        <ion-list lines="full">
            <ion-item>
              <ion-label>{{ 'Rating' | translate }}</ion-label>
              <app-rating-input formControlName="rate" max="5"></app-rating-input>
            </ion-item>    
            <ion-item>
              <ion-label position="floating">{{ 'Review' | translate }}</ion-label>
              <ion-textarea autocapitalize rows="6" cols="20" formControlName="review"></ion-textarea>
            </ion-item>
        </ion-list>
      </section>
      <section *ngIf="ratingSection">
        <ion-grid class="ion-padding-start ion-padding" >
          <ion-row>
            <ion-col>
          <ion-label color="danger">{{ 'UsersRating' | translate }}</ion-label>
           </ion-col>
          </ion-row>
          <div *ngFor="let rating of userRating | async"> 
          <ion-row>
            <ion-col  class="header my-message ion-padding">
            <b>{{ rating.userFirstname }}</b> ({{ rating.stars }} {{ 'Of' | translate }} 5 {{ 'Stars' | translate }})
            <div class="time-my-message" text-right *ngIf="rating.review == ''">
              {{rating.createdDate?.seconds * 1000 | date:'dd, MMM, yyyy hh:mm a'}}
            </div>
          </ion-col>
          </ion-row>
          <ion-row>
          <ion-col class="message other-message ion-padding-bottom" *ngIf="rating.review != ''">
            <div class="ion-padding">{{rating.review}}</div>
            <div class="time-my-message" text-right><br>
              {{rating.createdDate?.seconds * 1000 | date:'dd, MMM, yyyy hh:mm a'}}
            </div>
            
          </ion-col>
          </ion-row>
        </div>
         </ion-grid> 
      </section>
  </ion-content>
  <ion-footer>
    <ion-row>
      <ion-col>
        <ion-button expand="block" color="danger" type="submit" fill="solid" [disabled]="!(reviewItemForm.valid && reviewItemForm.dirty)">{{ 'Review' | translate }}</ion-button>
      </ion-col>
    </ion-row>
  </ion-footer>
</form>
